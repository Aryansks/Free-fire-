<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FF SENSI TOOL</title>
<style>
body{margin:0;font-family:Arial,sans-serif;background:#f5f5f5;color:#111;}
header{display:flex;justify-content:space-between;align-items:center;padding:10px;background:#fff;border-bottom:3px solid red;position:sticky;top:0;z-index:100;}
button{padding:10px 20px;margin:5px;font-size:16px;background:red;color:#fff;border:none;border-radius:8px;cursor:pointer;transition:0.2s;}
button:hover{background:#ff4d4d;transform:scale(1.05);}
.hidden{display:none;}
.container{padding:20px;}
h1,h2,h3{color:red;}
.scrollable{max-height:200px;overflow-y:auto;padding-right:5px;background:#fff;color:#111;border-radius:8px;padding:10px;margin-bottom:10px;}
input,select,textarea{padding:10px;margin:5px 0;width:100%;border-radius:8px;border:1px solid #ccc;background:#fff;color:#111;}
.card{border:1px solid red;padding:10px;margin:5px;border-radius:8px;background:#fff;transition:0.2s;}
.card:hover{background:#ffe6e6;}
#cartBtn{position:fixed;top:15px;right:15px;}
.announcement{animation:fadeIn 1s;}
.req-pending{color:orange;}
.req-accepted{color:green;}
.req-declined{color:red;}
@keyframes fadeIn{0%{opacity:0;}100%{opacity:1;}}
</style>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
</head>
<body>

<header>
<div id="headerUser">Not logged</div>
<button id="logoutBtn" class="hidden" onclick="logout()">LOGOUT</button>
<button id="cartBtn" class="hidden" onclick="openCart()">ðŸ›’</button>
</header>

<div class="container" id="welcomeDiv">
<h1>ðŸ”¥ FF SENSI TOOL</h1>
<button onclick="showLogin()">LOGIN</button>
</div>

<div class="container hidden" id="loginDiv">
<h1>Login</h1>
<input type="text" id="loginUser" placeholder="Enter username">
<button id="loginBtn" onclick="login()">Login</button>
</div>

<div class="container hidden" id="homeDiv">
<h1>Welcome <span id="uname"></span></h1>
<div id="announcements" class="scrollable">No announcements yet</div>
<button id="sensiBtn" onclick="showSensi()">SENSI</button>
<button id="requestsBtn" onclick="showRequests()">REQUESTS</button>
</div>

<div class="container hidden" id="sensiDiv">
<h2>Select Company & Model</h2>
<select id="companySelect" onchange="renderModels()"></select>
<div id="modelList"></div>
<button onclick="backHome()">Back</button>
</div>

<div class="container hidden" id="requestsDiv">
<h2>My Requests</h2>
<div id="reqList" class="scrollable">No requests yet</div>
<button onclick="backHome()">Back</button>
</div>

<div class="container hidden" id="cartDiv">
<h2>ðŸ›’ My Cart</h2>
<div id="cartItems" class="scrollable">No items in cart</div>
<button onclick="continueCart()">Continue</button>
<button onclick="backHome()">Back</button>
</div>

<div class="container hidden" id="buyFormDiv">
<h2>Fill Form</h2>
<input type="text" id="buyName" placeholder="First Name"><br>
<input type="text" id="buyLast" placeholder="Last Name"><br>
<input type="text" id="buyUID" placeholder="In-Game UID"><br>
<button onclick="sendBuyRequest()">Send Request</button>
<button onclick="backHome()">Cancel</button>
</div>

<div class="container hidden" id="devDiv">
<h2>Developer Panel</h2>
<h3>User Requests</h3>
<div id="devReqList" class="scrollable">No requests yet</div>
<h3>Manage Announcements</h3>
<textarea id="announcementText" placeholder="Type announcement..." style="width:100%;height:60px;"></textarea><br>
<button onclick="sendAnnouncement()">Send Announcement</button>
<div id="devAnnList" class="scrollable"></div>
</div>

<script>
// Firebase Config
const firebaseConfig = {
    apiKey: "AIzaSyDYwUTHildowbImBqOHgIPM0pp0EVdd2UQ",
    authDomain: "free-fire-sensi-c7674.firebaseapp.com",
    databaseURL: "https://free-fire-sensi-c7674-default-rtdb.firebaseio.com",
    projectId: "free-fire-sensi-c7674",
    storageBucket: "free-fire-sensi-c7674.firebasestorage.app",
    messagingSenderId: "282496876553",
    appId: "1:282496876553:web:37e784f17ddcf5ae0bf8d8"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

let currentUser = null, selectedCompany = '', selectedModel = '', cart = [];
const DEV_PASS = "999";

// Companies & Models
const COMPANIES = {
    "Xiaomi":["Redmi Note 13 Pro ðŸ“±","Redmi Note 13 Pro+ ðŸ”¥","Mi 12 ðŸŒ€","Mi 11 âš¡","Poco X6 Pro ðŸŽ¯","Redmi 12C","Redmi 11 Prime","Redmi K60 Ultra"],
    "iPhone":["iPhone 16e ðŸ","iPhone 15 Pro ðŸŒŸ","iPhone 15","iPhone 14 Pro","iPhone 14","iPhone 13","iPhone 12 Mini","iPhone SE 3"],
    "Samsung":["Galaxy S24 Ultra ðŸ’Ž","Galaxy S23 Ultra","Galaxy S23+","Galaxy S23","Galaxy A54","Galaxy A14","Galaxy Z Fold5","Galaxy Z Flip5"],
    "Nothing":["Nothing Phone 1 ðŸ”µ","Nothing Phone 1T ðŸŒŸ","Nothing Phone 2 ðŸŸ¡","Nothing Phone 2T âš¡","Nothing Phone 3 Pro ðŸŒ€","Nothing Phone 3a ðŸŒŸ","Nothing Phone 4 ðŸŸ¢","Nothing Phone 4a ðŸ”´"],
    "Oppo":["Oppo Reno 10 Pro","Oppo F23","Oppo A77","Oppo Find X6"],
    "Realme":["Realme GT3","Realme 12 Pro","Realme 11i","Realme Narzo 60x"],
    "Vivo":["Vivo X100 Pro","Vivo V29","Vivo Y36","Vivo Y22"],
    "OnePlus":["OnePlus 12","OnePlus 11R","OnePlus Nord 3","OnePlus 10T"],
    "Huawei":["Huawei P60 Pro","Huawei Mate 60","Huawei Nova 12","Huawei Y9a"],
    "Motorola":["Moto Edge 40","Moto G73","Moto G72","Moto X40"],
    "LG":["LG Velvet 2","LG Wing 5G","LG V70","LG K62"],
    "Nokia":["Nokia X30","Nokia G60","Nokia 5710","Nokia XR20"],
    "Sony":["Sony Xperia 1 V","Sony Xperia 5 IV","Sony Xperia 10 IV","Sony Xperia L4"],
    "Asus":["Asus ROG Phone 7","Asus Zenfone 10","Asus Zenfone 9","Asus ROG Phone 6"],
    "Honor":["Honor Magic 5","Honor 90","Honor X9a","Honor 80"]
};

// Best SENSI for each device
const DEVICE_SENSI = {};
for(const c in COMPANIES){
    COMPANIES[c].forEach(m=>{
        DEVICE_SENSI[m] = {
            GENERAL: Math.floor(Math.random()*50)+150,
            "RED DOT": Math.floor(Math.random()*50)+150,
            "2X": Math.floor(Math.random()*50)+150,
            "4X": Math.floor(Math.random()*50)+150,
            "SNIPER SCOPE": Math.floor(Math.random()*50)+150,
            "FREE CAMERA": Math.floor(Math.random()*50)+150
        };
    });
}

// --- Functions ---
function showLogin(){document.getElementById('welcomeDiv').classList.add('hidden');document.getElementById('loginDiv').classList.remove('hidden');}
function logout(){currentUser=null;document.getElementById('loginDiv').classList.remove('hidden');document.getElementById('homeDiv').classList.add('hidden');document.getElementById('headerUser').innerText="Not logged";document.getElementById('logoutBtn').classList.add('hidden');document.getElementById('cartBtn').classList.add('hidden');document.getElementById('devDiv').classList.add('hidden');}
function backHome(){document.getElementById('homeDiv').classList.remove('hidden');document.getElementById('sensiDiv').classList.add('hidden');document.getElementById('requestsDiv').classList.add('hidden');document.getElementById('cartDiv').classList.add('hidden');document.getElementById('buyFormDiv').classList.add('hidden');}
function showSensi(){document.getElementById('homeDiv').classList.add('hidden');document.getElementById('sensiDiv').classList.remove('hidden');populateCompanies();}
function showRequests(){document.getElementById('homeDiv').classList.add('hidden');document.getElementById('requestsDiv').classList.remove('hidden');fetchUserRequests();}
function openCart(){document.getElementById('homeDiv').classList.add('hidden');document.getElementById('cartDiv').classList.remove('hidden');populateCart();}
function continueCart(){document.getElementById('cartDiv').classList.add('hidden');document.getElementById('buyFormDiv').classList.remove('hidden');}

// Populate Companies & Models
function populateCompanies(){
    const sel=document.getElementById('companySelect');
    sel.innerHTML='<option value="">Select Company</option>';
    for(const c in COMPANIES){let opt=document.createElement('option');opt.value=c;opt.innerText=c;sel.appendChild(opt);}
    document.getElementById('modelList').innerHTML='';
}
function renderModels(){
    selectedCompany=document.getElementById('companySelect').value;
    const div=document.getElementById('modelList'); div.innerHTML='';
    if(!selectedCompany) return;
    COMPANIES[selectedCompany].forEach(model=>{
        const card=document.createElement('div'); card.className='card';
        card.innerHTML=`<b>${model}</b><br>
        <button onclick="openBuy('${model}')">Buy Now</button> 
        <button onclick="addToCart('${model}')">Add to Cart</button>`;
        div.appendChild(card);
    });
}

// Buy / Cart
function openBuy(model){selectedModel=model;document.getElementById('sensiDiv').classList.add('hidden');document.getElementById('buyFormDiv').classList.remove('hidden');}
function addToCart(model){cart.push(model);alert(model+' added to cart');}
function populateCart(){
    const div=document.getElementById('cartItems'); div.innerHTML='';
    if(cart.length===0){div.innerText='No items in cart'; return;}
    cart.forEach(m=>{
        const card=document.createElement('div'); card.className='card'; card.innerText=m; div.appendChild(card);
    });
}

// Send Buy Request
function sendBuyRequest(){
    if(!selectedModel){alert('Select a model'); return;}
    const first=document.getElementById('buyName').value.trim();
    const last=document.getElementById('buyLast').value.trim();
    const uid=document.getElementById('buyUID').value.trim();
    if(!first||!last||!uid){alert('Fill all fields'); return;}
    const reqId=db.ref('requests').push().key;
    db.ref('requests/'+reqId).set({
        user: currentUser,
        device: selectedModel,
        first,
        last,
        uid,
        status:'PENDING',
        sensi: DEVICE_SENSI[selectedModel]
    });
    alert('Request sent!'); backHome();
}

// Fetch User Requests
function fetchUserRequests(){
    const div=document.getElementById('reqList'); div.innerHTML='';
    db.ref('requests').orderByChild('user').equalTo(currentUser).on('value', snap=>{
        div.innerHTML='';
        snap.forEach(s=>{
            const r=s.val(); const status=r.status;
            const card=document.createElement('div'); card.className='card';
            let statusClass=status==='PENDING'?'req-pending':status==='ACCEPTED'?'req-accepted':'req-declined';
            card.innerHTML=`Device: ${r.device}<br>Username: ${r.user}<br>Status: <span class="${statusClass}">${status}</span>`;
            if(status==='ACCEPTED'){
                card.innerHTML+=`<br><b>SENSI:</b><br>`;
                for(const k in r.sensi){card.innerHTML+=`${k}: ${r.sensi[k]}<br>`;}
            }
            div.appendChild(card);
        });
    });
}

// Developer Requests
function fetchDevRequests(){
    const div=document.getElementById('devReqList'); div.innerHTML='';
    db.ref('requests').orderByChild('status').equalTo('PENDING').on('value', snap=>{
        div.innerHTML='';
        snap.forEach(s=>{
            const r=s.val(); const id=s.key;
            const card=document.createElement('div'); card.className='card';
            card.innerHTML=`${r.user} - ${r.device} 
            <button onclick="devAccept('${id}')">Accept</button> 
            <button onclick="devDecline('${id}')">Decline</button>`;
            div.appendChild(card);
        });
    });
}

function devAccept(id){db.ref('requests/'+id).update({status:'ACCEPTED'});}
function devDecline(id){db.ref('requests/'+id).update({status:'DECLINED'});}

// Announcements
function sendAnnouncement(){
    const text=document.getElementById('announcementText').value.trim();
    if(!text){alert('Enter announcement'); return;}
    const annId=db.ref('announcements').push().key;
    db.ref('announcements/'+annId).set({text, by: currentUser});
    document.getElementById('announcementText').value='';
    fetchAnnouncements();
}
function fetchAnnouncements(){
    const div=document.getElementById('announcements'); div.innerHTML='';
    db.ref('announcements').on('value', snap=>{
        div.innerHTML='';
        snap.forEach(s=>{
            const a=s.val();
            const card=document.createElement('div'); card.className='card announcement';
            card.innerText=a.text;
            div.appendChild(card);
        });
    });
}

// Login
function login(){
    const uname = document.getElementById('loginUser').value.trim();
    if(!uname){alert('Enter username'); return;}
    currentUser = uname;
    document.getElementById('uname').innerText = currentUser;
    document.getElementById('loginDiv').classList.add('hidden');
    document.getElementById('homeDiv').classList.remove('hidden');
    document.getElementById('headerUser').innerText = currentUser;
    document.getElementById('logoutBtn').classList.remove('hidden');
    document.getElementById('cartBtn').classList.remove('hidden');
    // Developer login
    if(uname.toLowerCase() === "dev999"){
        document.getElementById('devDiv').classList.remove('hidden');
        document.getElementById('homeDiv').classList.add('hidden');
    }
}

// On Load
window.onload=function(){fetchUserRequests();fetchDevRequests();fetchAnnouncements();populateCompanies();}
</script>

</body>
</html>
