<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Free Fire Max Sensitivity</title>
<style>
body { font-family: Arial, sans-serif; background-color: #1a1a1a; color: #fff; margin:0; padding:0;}
.hidden { display: none; }
button { background-color: #e53935; color: #fff; border: none; padding: 10px 15px; margin: 5px; cursor: pointer; border-radius:5px; }
button:hover { opacity:0.9; }
.container { padding: 20px; }
#companySelect, #modelSelect { margin: 10px 0; padding:5px; }
.card { background:#2c2c2c; padding:10px; margin:10px 0; border-radius:5px; }
.request-card { background:#333; padding:10px; margin:10px 0; border-radius:5px; }
</style>
</head>
<body>

<div id="welcomeDiv" class="container">
<h1>Welcome to Free Fire Max Sensitivity</h1>
<button onclick="showLogin()">Login</button>
</div>

<div id="loginDiv" class="container hidden">
<h2>Login</h2>
<input type="text" id="usernameInput" placeholder="Username">
<input type="password" id="passwordInput" placeholder="Password">
<br>
<button onclick="login()">Login</button>
</div>

<div id="homeDiv" class="container hidden">
<h2>User Panel</h2>
<button onclick="showSensi()">SENSI</button>
<button onclick="showRequests()">REQUESTS</button>
<button onclick="openCart()">ðŸ›’ Cart</button>
<button onclick="logout()">Logout</button>

<div id="companyDiv" class="hidden">
<select id="companySelect" onchange="populateModels()"></select>
<select id="modelSelect"></select>
<button onclick="openBuyForm()">Buy Now</button>
<button onclick="addToCart()">ðŸ›’ Add to Cart</button>
</div>

<div id="sensiDiv" class="hidden"></div>
<div id="requestsDiv" class="hidden"></div>
<div id="cartDiv" class="hidden"></div>
</div>

<div id="devDiv" class="container hidden">
<h2>Developer Panel</h2>
<button onclick="showDevRequests()">Requests</button>
<button onclick="showAnnouncements()">Announcements</button>
<button onclick="logout()">Logout</button>
<div id="devRequestsDiv" class="hidden"></div>
<div id="devAnnouncementsDiv" class="hidden"></div>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
<script>
// --- Firebase Config ---
const firebaseConfig = {
  apiKey: "AIzaSyDYwUTHildowbImBqOHgIPM0pp0EVdd2UQ",
  authDomain: "free-fire-sensi-c7674.firebaseapp.com",
  databaseURL: "https://free-fire-sensi-c7674-default-rtdb.firebaseio.com",
  projectId: "free-fire-sensi-c7674",
  storageBucket: "free-fire-sensi-c7674.appspot.com",
  messagingSenderId: "282496876553",
  appId: "1:282496876553:web:37e784f17ddcf5ae0bf8d8"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// --- Global Variables ---
let currentUser = null;
let selectedCompany = '';
let selectedModel = '';
let cart = [];

// --- Device Sensitivities (fixed per model) ---
const DEVICE_SENSI = {
"Xiaomi": {
"Redmi Note 13 Pro": { GENERAL: 175, "RED DOT": 155, "2X": 160, "4X": 140, "SNIPER SCOPE": 135, "FREE CAMERA": 145 },
"Redmi Note 13 Pro+": { GENERAL: 171, "RED DOT": 157, "2X": 162, "4X": 142, "SNIPER SCOPE": 137, "FREE CAMERA": 147 },
"Mi 12": { GENERAL: 155, "RED DOT": 160, "2X": 165, "4X": 145, "SNIPER SCOPE": 140, "FREE CAMERA": 150 }
},
"iPhone": {
"iPhone 16e": { GENERAL: 175, "RED DOT": 160, "2X": 162, "4X": 150, "SNIPER SCOPE": 145, "FREE CAMERA": 155 },
"iPhone 15 Pro": { GENERAL: 172, "RED DOT": 158, "2X": 160, "4X": 148, "SNIPER SCOPE": 142, "FREE CAMERA": 150 }
},
"Samsung": {
"Galaxy S24 Ultra": { GENERAL: 155, "RED DOT": 160, "2X": 165, "4X": 145, "SNIPER SCOPE": 140, "FREE CAMERA": 150 },
"Galaxy Z Flip5": { GENERAL: 153, "RED DOT": 158, "2X": 163, "4X": 143, "SNIPER SCOPE": 138, "FREE CAMERA": 148 }
},
"Nothing": {
"Nothing Phone 1": { GENERAL: 170, "RED DOT": 180, "2X": 160, "4X": 150, "SNIPER SCOPE": 140, "FREE CAMERA": 170 }
},
"Oppo": {
"Oppo Reno 10 Pro": { GENERAL: 170, "RED DOT": 180, "2X": 160, "4X": 150, "SNIPER SCOPE": 140, "FREE CAMERA": 170 }
"Oppo F23": { GENERAL: 168, "RED DOT": 178, "2X": 158, "4X": 148, "SNIPER SCOPE": 138, "FREE CAMERA": 168 },
"Oppo A77": { GENERAL: 165, "RED DOT": 175, "2X": 155, "4X": 145, "SNIPER SCOPE": 135, "FREE CAMERA": 165 },
"Oppo Find X6": { GENERAL: 172, "RED DOT": 182, "2X": 162, "4X": 152, "SNIPER SCOPE": 142, "FREE CAMERA": 172 }
},
"Realme": {
"Realme GT3": { GENERAL: 170, "RED DOT": 180, "2X": 160, "4X": 150, "SNIPER SCOPE": 140, "FREE CAMERA": 170 },
"Realme 12 Pro": { GENERAL: 168, "RED DOT": 178, "2X": 158, "4X": 148, "SNIPER SCOPE": 138, "FREE CAMERA": 168 },
"Realme 11i": { GENERAL: 165, "RED DOT": 175, "2X": 155, "4X": 145, "SNIPER SCOPE": 135, "FREE CAMERA": 165 },
"Realme Narzo 60x": { GENERAL: 172, "RED DOT": 182, "2X": 162, "4X": 152, "SNIPER SCOPE": 142, "FREE CAMERA": 172 }
},
"Vivo": {
"Vivo X100 Pro": { GENERAL: 175, "RED DOT": 185, "2X": 165, "4X": 155, "SNIPER SCOPE": 145, "FREE CAMERA": 175 },
"Vivo V29": { GENERAL: 170, "RED DOT": 180, "2X": 160, "4X": 150, "SNIPER SCOPE": 140, "FREE CAMERA": 170 },
"Vivo Y36": { GENERAL: 168, "RED DOT": 178, "2X": 158, "4X": 148, "SNIPER SCOPE": 138, "FREE CAMERA": 168 },
"Vivo Y22": { GENERAL: 165, "RED DOT": 175, "2X": 155, "4X": 145, "SNIPER SCOPE": 135, "FREE CAMERA": 165 }
},
"OnePlus": {
"OnePlus 12": { GENERAL: 180, "RED DOT": 190, "2X": 170, "4X": 160, "SNIPER SCOPE": 150, "FREE CAMERA": 180 },
"OnePlus 11R": { GENERAL: 175, "RED DOT": 185, "2X": 165, "4X": 155, "SNIPER SCOPE": 145, "FREE CAMERA": 175 },
"OnePlus Nord 3": { GENERAL: 172, "RED DOT": 182, "2X": 162, "4X": 152, "SNIPER SCOPE": 142, "FREE CAMERA": 172 },
"OnePlus 10T": { GENERAL: 170, "RED DOT": 180, "2X": 160, "4X": 150, "SNIPER SCOPE": 140, "FREE CAMERA": 170 }
},
"Huawei": {
"Huawei P60 Pro": { GENERAL: 175, "RED DOT": 185, "2X": 165, "4X": 155, "SNIPER SCOPE": 145, "FREE CAMERA": 175 },
"Huawei Mate 60": { GENERAL: 172, "RED DOT": 182, "2X": 162, "4X": 152, "SNIPER SCOPE": 142, "FREE CAMERA": 172 },
"Huawei Nova 12": { GENERAL: 170, "RED DOT": 180, "2X": 160, "4X": 150, "SNIPER SCOPE": 140, "FREE CAMERA": 170 },
"Huawei Y9a": { GENERAL: 168, "RED DOT": 178, "2X": 158, "4X": 148, "SNIPER SCOPE": 138, "FREE CAMERA": 168 }
},
"Motorola": {
"Moto Edge 40": { GENERAL: 170, "RED DOT": 180, "2X": 160, "4X": 150, "SNIPER SCOPE": 140, "FREE CAMERA": 170 },
"Moto G73": { GENERAL: 168, "RED DOT": 178, "2X": 158, "4X": 148, "SNIPER SCOPE": 138, "FREE CAMERA": 168 },
"Moto G72": { GENERAL: 165, "RED DOT": 175, "2X": 155, "4X": 145, "SNIPER SCOPE": 135, "FREE CAMERA": 165 },
"Moto X40": { GENERAL: 172, "RED DOT": 182, "2X": 162, "4X": 152, "SNIPER SCOPE": 142, "FREE CAMERA": 172 }
},
"LG": {
"LG Velvet 2": { GENERAL: 170, "RED DOT": 180, "2X": 160, "4X": 150, "SNIPER SCOPE": 140, "FREE CAMERA": 170 },
"LG Wing 5G": { GENERAL: 168, "RED DOT": 178, "2X": 158, "4X": 148, "SNIPER SCOPE": 138, "FREE CAMERA": 168 },
"LG V70": { GENERAL: 165, "RED DOT": 175, "2X": 155, "4X": 145, "SNIPER SCOPE": 135, "FREE CAMERA": 165 },
"LG K62": { GENERAL: 162, "RED DOT": 172, "2X": 152, "4X": 142, "SNIPER SCOPE": 132, "FREE CAMERA": 162 }
},
"Nokia": {
"Nokia X30": { GENERAL: 168, "RED DOT": 178, "2X": 158, "4X": 148, "SNIPER SCOPE": 138, "FREE CAMERA": 168 },
"Nokia G60": { GENERAL: 165, "RED DOT": 175, "2X": 155, "4X": 145, "SNIPER SCOPE": 135, "FREE CAMERA": 165 },
"Nokia 5710": { GENERAL: 162, "RED DOT": 172, "2X": 152, "4X": 142, "SNIPER SCOPE": 132, "FREE CAMERA": 162 },
"Nokia XR20": { GENERAL: 170, "RED DOT": 180, "2X": 160, "4X": 150, "SNIPER SCOPE": 140, "FREE CAMERA": 170 }
},
"Sony": {
"Sony Xperia 1 V": { GENERAL: 175, "RED DOT": 185, "2X": 165, "4X": 155, "SNIPER SCOPE": 145, "FREE CAMERA": 175 },
"Sony Xperia 5 IV": { GENERAL: 172, "RED DOT": 182, "2X": 162, "4X": 152, "SNIPER SCOPE": 142, "FREE CAMERA": 172 },
"Sony Xperia 10 IV": { GENERAL: 168, "RED DOT": 178, "2X": 158, "4X": 148, "SNIPER SCOPE": 138, "FREE CAMERA": 168 },
"Sony Xperia L4": { GENERAL: 165, "RED DOT": 175, "2X": 155, "4X": 145, "SNIPER SCOPE": 135, "FREE CAMERA": 165 }
},
"Asus": {
"Asus ROG Phone 7": { GENERAL: 180, "RED DOT": 190, "2X": 170, "4X": 160, "SNIPER SCOPE": 150, "FREE CAMERA": 180 },
"Asus Zenfone 10": { GENERAL: 175, "RED DOT": 185, "2X": 165, "4X": 155, "SNIPER SCOPE": 145, "FREE CAMERA": 175 },
"Asus ROG Phone 6": { GENERAL: 172, "RED DOT": 182, "2X": 162, "4X": 152, "SNIPER SCOPE": 142, "FREE CAMERA": 172 },
"Asus ROG Phone 5": { GENERAL: 170, "RED DOT": 180, "2X": 160, "4X": 150, "SNIPER SCOPE": 140, "FREE CAMERA": 170 }
}
}; 

// --- Functions ---
// Populate Companies
function populateCompanies(){
  const companySelect = document.getElementById('companySelect');
  companySelect.innerHTML = '<option value="">Select Company</option>';
  Object.keys(DEVICE_SENSI).forEach(c => {
    let opt = document.createElement('option'); opt.value = c; opt.textContent = c;
    companySelect.appendChild(opt);
  });
}

// Populate Models
function populateModels(){
  const modelSelect = document.getElementById('modelSelect');
  const company = document.getElementById('companySelect').value;
  modelSelect.innerHTML = '<option value="">Select Model</option>';
  if(company && DEVICE_SENSI[company]){
    Object.keys(DEVICE_SENSI[company]).forEach(m=>{
      let opt = document.createElement('option'); opt.value = m; opt.textContent = m;
      modelSelect.appendChild(opt);
    });
  }
}

// Login
function login(){
  const username = document.getElementById('usernameInput').value.trim();
  const password = document.getElementById('passwordInput').value.trim();
  if(username && password){
    if(username.toUpperCase() === 'DEV999' && password === '999'){
      currentUser = username;
      localStorage.setItem('ffSensiUser', currentUser);
      showDevPanel();
    } else {
      currentUser = username;
      localStorage.setItem('ffSensiUser', currentUser);
      showUserPanel();
    }
  } else { 
    alert('Enter credentials'); 
  }
}

// Logout
function logout(){
  currentUser = null;
  localStorage.removeItem('ffSensiUser');
  document.getElementById('welcomeDiv').classList.remove('hidden');
  document.getElementById('loginDiv').classList.add('hidden');
  document.getElementById('homeDiv').classList.add('hidden');
  document.getElementById('devDiv').classList.add('hidden');
}

// Show Panels
function showLogin(){
  document.getElementById('welcomeDiv').classList.add('hidden');
  document.getElementById('loginDiv').classList.remove('hidden');
}
function showUserPanel(){
  document.getElementById('loginDiv').classList.add('hidden');
  document.getElementById('homeDiv').classList.remove('hidden');
  document.getElementById('welcomeDiv').classList.add('hidden');
  document.getElementById('companyDiv').classList.remove('hidden');
}
function showDevPanel(){
  document.getElementById('loginDiv').classList.add('hidden');
  document.getElementById('devDiv').classList.remove('hidden');
  document.getElementById('welcomeDiv').classList.add('hidden');
}

// Show SENSI
function showSensi(){
  document.getElementById('sensiDiv').classList.remove('hidden');
  const company = document.getElementById('companySelect').value;
  const model = document.getElementById('modelSelect').value;
  const div = document.getElementById('sensiDiv');
  if(company && model){
    const sensi = DEVICE_SENSI[company][model];
    div.innerHTML = `<h3>${company} - ${model} Sensitivity</h3>`;
    Object.keys(sensi).forEach(k=>{
      div.innerHTML += `<p>${k}: ${sensi[k]}</p>`;
    });
  } else {
    div.innerHTML = '<p>Please select company and model</p>';
  }
}

// CART
function addToCart(){
  const company = document.getElementById('companySelect').value;
  const model = document.getElementById('modelSelect').value;
  if(company && model){
    cart.push({company, model});
    alert('Added to cart');
  } else { alert('Select company and model'); }
}

function openCart(){
  const div = document.getElementById('cartDiv');
  div.classList.remove('hidden');
  div.innerHTML = '<h3>Cart</h3>';
  if(cart.length === 0){ div.innerHTML += '<p>Cart is empty</p>'; return; }
  cart.forEach((item,i)=>{
    div.innerHTML += `<p>${i+1}. ${item.company} - ${item.model}</p>`;
  });
  div.innerHTML += `<button onclick="sendCartRequest()">Continue</button>`;
}

// Send cart request to Firebase
function sendCartRequest(){
  cart.forEach(item=>{
    const newReq = db.ref('requests').push();
    newReq.set({
      uid: currentUser,
      username: currentUser,
      company: item.company,
      model: item.model,
      status: 'PENDING'
    });
  });
  cart = [];
  document.getElementById('cartDiv').innerHTML = '<p>Request sent!</p>';
}

// USER REQUESTS
function showRequests(){
  const div = document.getElementById('requestsDiv');
  div.classList.remove('hidden');
  div.innerHTML = '<h3>Your Requests</h3>';
  db.ref('requests').once('value', snapshot=>{
    const data = snapshot.val();
    if(!data) { div.innerHTML += '<p>No requests found</p>'; return; }
    Object.keys(data).forEach(key=>{
      const req = data[key];
      if(req.username === currentUser){
        div.innerHTML += `<div class="request-card">
        ðŸ“±Model: ${req.model}<br>
        Username: ${req.username}<br>
        STATUS: ${req.status}<br>`;
        if(req.status === 'ACCEPTED'){
          const sensi = DEVICE_SENSI[req.company][req.model];
          Object.keys(sensi).forEach(k=>{
            div.innerHTML += `âœ…${k}: ${sensi[k]}<br>`;
          });
        }
        if(req.status !== 'PENDING'){
          div.innerHTML += `<button onclick="deleteRequest('${key}')">Delete Request</button>`;
        }
        div.innerHTML += `</div>`;
      }
    });
  });
}

function deleteRequest(key){
  db.ref('requests/'+key).remove();
  showRequests();
}

// DEVELOPER PANEL
function showDevRequests(){
  const div = document.getElementById('devRequestsDiv');
  div.classList.remove('hidden');
  div.innerHTML = '<h3>Incoming Requests</h3>';
  db.ref('requests').once('value', snapshot=>{
    const data = snapshot.val();
    if(!data) { div.innerHTML += '<p>No requests</p>'; return; }
    Object.keys(data).forEach(key=>{
      const req = data[key];
      div.innerHTML += `<div class="request-card">
        ðŸ“±${req.company} - ${req.model}<br>
        User: ${req.username}<br>
        STATUS: ${req.status}<br>
        <button onclick="updateRequest('${key}','ACCEPTED')">Accept</button>
        <button onclick="updateRequest('${key}','DECLINED')">Decline</button>
      </div>`;
    });
  });
}

function updateRequest(key,status){
  db.ref('requests/'+key).update({status});
  showDevRequests();
}

// ANNOUNCEMENTS
function showAnnouncements(){
  const div = document.getElementById('devAnnouncementsDiv');
  div.classList.remove('hidden');
  div.innerHTML = '<h3>Announcements</h3>';
  db.ref('announcements').once('value', snapshot=>{
    const data = snapshot.val();
    if(!data){ div.innerHTML += '<p>No announcements</p>'; return; }
    Object.keys(data).forEach(key=>{
      div.innerHTML += `<div class="card">${data[key]}</div>`;
    });
  });
}

// One-time login
window.onload = function(){
  const savedUser = localStorage.getItem('ffSensiUser');
  if(savedUser){
    currentUser = savedUser;
    if(currentUser.toUpperCase() === 'DEV999'){ showDevPanel(); }
    else { showUserPanel(); }
  } else {
    document.getElementById('welcomeDiv').classList.remove('hidden');
  }
  populateCompanies();
};
</script>
</body>
</html>
