<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>🔥 Free Fire Sensi Hub</title>
<style>
body{margin:0;font-family:Arial,sans-serif;background:#0b0f1a;color:#fff;}
header{display:flex;justify-content:space-between;align-items:center;padding:10px;background:#0a0a0a;border-bottom:3px solid red;position:sticky;top:0;z-index:100;}
button{padding:10px 20px;margin:5px;font-size:16px;background:red;color:#fff;border:none;border-radius:8px;cursor:pointer;transition:0.2s;}
button:hover{background:#ff4d4d;transform:scale(1.05);}
.hidden{display:none;}
.container{padding:20px;}
h1,h2,h3{color:red;}
.scrollable{max-height:200px;overflow-y:auto;padding-right:5px;}
.req-pending{color:yellow;}
.req-accepted{color:limegreen;}
.req-declined{color:red;}
input,select,textarea{padding:10px;margin:5px 0;width:100%;border-radius:8px;border:none;background:#222;color:#fff;}
.model-buttons{display:flex;gap:10px;flex-wrap:wrap;}
</style>
</head>
<body>

<header>
<div id="headerUser">Not logged</div>
<div>
<button id="logoutBtn" class="hidden" onclick="logout()">LOGOUT</button>
<button id="cartBtn" class="hidden" onclick="openCart()">🛒 Cart</button>
</div>
</header>

<div class="container" id="welcomeDiv">
<h1>🔥 Free Fire Sensi Hub</h1>
<button onclick="showLogin()">LOGIN</button>
</div>

<div class="container hidden" id="loginDiv">
<h1>Login</h1>
<input type="text" id="loginUser" placeholder="Enter username">
<button id="loginBtn">Login</button>
</div>

<div class="container hidden" id="homeDiv">
<h1>Welcome <span id="uname"></span></h1>
<div id="announcements" class="scrollable"></div>
<button id="sensiBtn" onclick="showSensi()">SENSI</button>
<button id="requestsBtn" onclick="showRequests()">REQUESTS</button>
</div>

<div class="container hidden" id="sensiDiv">
<h2>Select Company & Model</h2>
<select id="companySelect" onchange="renderModels()"></select>
<div id="modelList"></div>
<button onclick="backHome()">Back</button>
</div>

<div class="container hidden" id="requestsDiv">
<h2>My Requests</h2>
<div id="reqList" class="scrollable">No requests yet</div>
<button onclick="backHome()">Back</button>
</div>

<div class="container hidden" id="cartDiv">
<h2>🛒 My Cart</h2>
<div id="cartItems" class="scrollable">No items in cart</div>
<button onclick="continueCart()">Continue</button>
<button onclick="backHome()">Back</button>
</div>

<div class="container hidden" id="buyFormDiv">
<h2>Fill Form</h2>
<input type="text" id="buyName" placeholder="First Name"><br>
<input type="text" id="buyLast" placeholder="Last Name"><br>
<input type="text" id="buyUID" placeholder="In-Game UID"><br>
<button onclick="sendBuyRequest()">Send Request</button>
<button onclick="backHome()">Cancel</button>
</div>

<div class="container hidden" id="devDiv">
<h2>Developer Panel</h2>
<button onclick="logout()">Logout</button>
<h3>User Requests</h3>
<div id="devReqList" class="scrollable">No requests yet</div>
<h3>Manage Announcements</h3>
<textarea id="announcementText" placeholder="Type announcement..." style="width:100%;height:60px;"></textarea><br>
<button onclick="sendAnnouncement()">Send Announcement</button>
<div id="devAnnList" class="scrollable"></div>
</div>

<script>
// --- Data ---
let currentUser=null;
let requests=JSON.parse(localStorage.getItem('requests'))||[];
let announcements=JSON.parse(localStorage.getItem('announcements'))||[];
let cart=[];

// Companies + Models
const COMPANIES={
"Xiaomi":["Redmi Note 13 Pro 📱","Redmi Note 13 Pro+ 🔥","Mi 12 🌀","Mi 11 ⚡","Poco X6 Pro 🎯","Redmi 12C","Redmi 11 Prime","Redmi K60 Ultra"],
"iPhone":["iPhone 16e 🍏","iPhone 15 Pro 🌟","iPhone 15","iPhone 14 Pro","iPhone 14","iPhone 13","iPhone 12 Mini","iPhone SE 3"],
"Samsung":["Galaxy S24 Ultra 💎","Galaxy S23 Ultra","Galaxy S23+","Galaxy S23","Galaxy A54","Galaxy A14","Galaxy Z Fold5","Galaxy Z Flip5"],
"Nothing":["Nothing Phone 1 🔵","Nothing Phone 1T 🌟","Nothing Phone 2 🟡","Nothing Phone 2T ⚡","Nothing Phone 3 Pro 🌀","Nothing Phone 3a 🌟","Nothing Phone 4 🟢","Nothing Phone 4a 🔴"]
};

// --- Login & One-time login ---
window.onload=function(){
    const storedUser=JSON.parse(localStorage.getItem('user'));
    if(storedUser){ currentUser=storedUser; afterLogin(); return; }
    document.getElementById('loginBtn').addEventListener('click', function(){
        const uname=document.getElementById('loginUser').value.trim();
        if(!uname){alert('Enter username');return;}
        if(uname.toUpperCase()==='DEV999'){
            const code=prompt('Enter developer password:');
            if(code!=='999'){alert('Wrong password');return;}
            currentUser={name:'DEV999',dev:true};
        } else { currentUser={name:uname,dev:false}; }
        localStorage.setItem('user',JSON.stringify(currentUser));
        afterLogin();
    });
};

// --- After Login ---
function afterLogin(){
    document.getElementById('loginDiv').classList.add('hidden');
    document.getElementById('homeDiv').classList.remove('hidden');
    document.getElementById('logoutBtn').classList.remove('hidden');
    document.getElementById('cartBtn').classList.remove('hidden');
    document.getElementById('uname').innerText=currentUser.name;
    document.getElementById('headerUser').innerText=currentUser.dev?'Developer':'User';
    populateAnnouncements();
    populateRequests();
    populateCompanies();
    if(currentUser.dev){
        document.getElementById('devDiv').classList.remove('hidden');
        document.getElementById('sensiBtn').style.display='none';
        document.getElementById('requestsBtn').style.display='none';
        populateDevRequests();
        renderDevAnnouncements();
    } else {
        document.getElementById('devDiv').classList.add('hidden');
        document.getElementById('sensiBtn').style.display='inline-block';
        document.getElementById('requestsBtn').style.display='inline-block';
    }
}

// --- Logout ---
function logout(){ localStorage.removeItem('user'); location.reload(); }

// --- Navigation ---
function showLogin(){document.getElementById('welcomeDiv').classList.add('hidden');document.getElementById('loginDiv').classList.remove('hidden');}
function backHome(){['sensiDiv','requestsDiv','buyFormDiv','cartDiv'].forEach(id=>document.getElementById(id).classList.add('hidden'));document.getElementById('homeDiv').classList.remove('hidden');}
function showSensi(){document.getElementById('homeDiv').classList.add('hidden');document.getElementById('sensiDiv').classList.remove('hidden');}
function showRequests(){document.getElementById('homeDiv').classList.add('hidden');document.getElementById('requestsDiv').classList.remove('hidden');}

// --- Populate Companies ---
function populateCompanies(){
    const select=document.getElementById('companySelect');
    select.innerHTML='<option value="">--Select Company--</option>';
    Object.keys(COMPANIES).forEach(c=>{
        const opt=document.createElement('option'); opt.value=c; opt.innerText=c; select.appendChild(opt);
    });
}

// --- Render Models ---
function renderModels(){
    const company=document.getElementById('companySelect').value;
    const listDiv=document.getElementById('modelList');
    listDiv.innerHTML='';
    if(!company) return;
    COMPANIES[company].forEach(model=>{
        const btnBuy=document.createElement('button');
        btnBuy.innerText='Buy Now';
        btnBuy.onclick=function(){ openBuyForm(company,model); };
        const btnCart=document.createElement('button');
        btnCart.innerText='Add to Cart';
        btnCart.onclick=function(){ addToCart(company,model); };
        const div=document.createElement('div');
        div.className='model-buttons';
        div.innerHTML=`<span>${model}</span>`;
        div.appendChild(btnBuy);
        div.appendChild(btnCart);
        listDiv.appendChild(div);
    });
}

// --- Buy Now Form ---
let currentBuyItem=null;
function openBuyForm(company,model){
    currentBuyItem={company,model};
    document.getElementById('sensiDiv').classList.add('hidden');
    document.getElementById('buyFormDiv').classList.remove('hidden');
}
function sendBuyRequest(){
    const f=document.getElementById('buyName').value.trim();
    const l=document.getElementById('buyLast').value.trim();
    const uid=document.getElementById('buyUID').value.trim();
    if(!f || !l || !uid){alert('Fill all fields'); return;}
    const sensi=Math.floor(Math.random()*191)+10; // 10-200
    const req={user:currentUser.name,item:currentBuyItem,sensi:sensi,status:'Pending',fname:f,lname:l,uid:uid};
    requests.push(req); localStorage.setItem('requests',JSON.stringify(requests));
    alert('Request sent!');
    document.getElementById('buyFormDiv').classList.add('hidden');
    backHome();
    populateRequests();
    populateDevRequests();
}

// --- Cart ---
function addToCart(company,model){
    cart.push({company,model});
    alert('Added to cart');
}
function openCart(){
    document.getElementById('homeDiv').classList.add('hidden');
    document.getElementById('cartDiv').classList.remove('hidden');
    const div=document.getElementById('cartItems'); div.innerHTML='';
    if(cart.length===0){ div.innerText='No items in cart'; return;}
    cart.forEach((c,i)=>{
        const d=document.createElement('div'); d.innerText=`${c.company} - ${c.model}`;
        div.appendChild(d);
    });
}
function continueCart(){
    if(cart.length===0){ alert('Cart empty'); return;}
    document.getElementById('cartDiv').classList.add('hidden');
    document.getElementById('buyFormDiv').classList.remove('hidden');
}

// --- User Requests ---
function populateRequests(){
    if(currentUser.dev) return;
    const div=document.getElementById('reqList');
    const userReq=requests.filter(r=>r.user===currentUser.name);
    if(userReq.length===0){ div.innerText='No requests yet'; return;}
    div.innerHTML='';
    userReq.forEach(r=>{
        const d=document.createElement('div');
        d.className='card';
        d.innerHTML=`${r.item.company} - ${r.item.model} | Status: <span class="req-${r.status.toLowerCase()}">${r.status}</span> | SENSI: ${r.status==='Accepted'?r.sensi:''}`;
        div.appendChild(d);
    });
}

// --- Developer Requests ---
function populateDevRequests(){
    if(!currentUser.dev) return;
    const div=document.getElementById('devReqList');
    const pending=requests.filter(r=>r.status==='Pending');
    if(pending.length===0){ div.innerText='No requests'; return;}
    div.innerHTML='';
    pending.forEach((r,i)=>{
        const d=document.createElement('div');
        d.className='card';
        d.innerHTML=`${r.user} | ${r.item.company} - ${r.item.model} <button onclick="acceptRequest(${i})">Accept</button> <button onclick="declineRequest(${i})">Decline</button>`;
        div.appendChild(d);
    });
}
function acceptRequest(index){
    const pending=requests.filter(r=>r.status==='Pending');
    const realIndex=requests.indexOf(pending[index]);
    requests[realIndex].status='Accepted';
    localStorage.setItem('requests',JSON.stringify(requests));
    populateDevRequests();
    populateRequests();
}
function declineRequest(index){
    const pending=requests.filter(r=>r.status==='Pending');
    const realIndex=requests.indexOf(pending[index]);
    requests[realIndex].status='Declined';
    localStorage.setItem('requests',JSON.stringify(requests));
    populateDevRequests();
    populateRequests();
}

// --- Announcements ---
function populateAnnouncements(){
    if(currentUser.dev) return;
    const div=document.getElementById('announcements');
    div.innerHTML='';
    if(announcements.length===0){ div.innerText='No announcements'; return;}
    announcements.forEach(a=>{
        const d=document.createElement('div'); d.className='card'; d.innerText=a; div.appendChild(d);
    });
}
function sendAnnouncement(){
    const txt=document.getElementById('announcementText').value.trim();
    if(!txt) return;
    announcements.push(txt); localStorage.setItem('announcements',JSON.stringify(announcements));
    renderDevAnnouncements(); populateAnnouncements();
    document.getElementById('announcementText').value='';
}
function renderDevAnnouncements(){
    const div=document.getElementById('devAnnList'); div.innerHTML='';
    announcements.forEach((a,i)=>{
        const d=document.createElement('div'); d.className='card'; d.innerHTML=`${a} <button onclick="deleteAnnouncement(${i})">Delete</button>`; div.appendChild(d);
    });
}
function deleteAnnouncement(i){
    announcements.splice(i,1); localStorage.setItem('announcements',JSON.stringify(announcements));
    renderDevAnnouncements(); populateAnnouncements();
}
</script>

</body>
</html>
